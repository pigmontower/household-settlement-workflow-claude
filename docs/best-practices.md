# Claude Code ベストプラクティス

このドキュメントでは、Claude Code を効果的に活用するためのベストプラクティスを紹介します。

CLAUDE.md やカスタムコマンドの詳細は [Claude Code リファレンス](claude-code-reference.md) を参照してください。

## 1. 効果的なプロンプティング

### 明確で具体的な指示を心がける

| パターン | 悪い例 | 良い例 |
|----------|--------|--------|
| 機能追加 | 「認証を追加して」 | 「メールとパスワードによるユーザー認証機能を追加してください。ログイン、ログアウト、セッション管理を含めてください」 |
| バグ修正 | 「動かない」 | 「このエラーが発生します：[エラーメッセージ]。期待する動作は〇〇ですが、実際は△△になります」 |
| リファクタリング | 「きれいにして」 | 「この関数を単一責任の原則に従って分割してください」 |

### コンテキストを提供する

プロンプトには以下の情報を含めると、より適切な回答が得られます：

1. **目的**: 何を達成したいか
2. **制約条件**: 使用する技術、パフォーマンス要件など
3. **期待する出力**: どのような形式で結果が欲しいか
4. **既存コードとの関係**: どのファイルを修正するか

例：

```
現在のプロジェクトに、外部 API を呼び出す機能を追加してください。

要件：
- src/api/ ディレクトリに実装
- エラーハンドリングを含める
- 環境変数から API キーを読み込む
- レスポンスの型定義を追加
```

## 2. 段階的なアプローチ

大きな機能は小さなステップに分割して依頼します。

1. **第1段階**: 基本的な構造を作成
2. **第2段階**: コア機能を実装
3. **第3段階**: エラーハンドリングを追加
4. **第4段階**: テストを作成
5. **第5段階**: リファクタリングと最適化

一度にすべてを依頼するのではなく、各ステップの結果を確認しながら進めることで、問題を早期に発見できます。

## 3. コードレビューの習慣

Claude Code が生成したコードは必ず確認しましょう。

### 確認ポイント

- **セキュリティ**: 機密情報の露出、インジェクション攻撃への脆弱性
- **パフォーマンス**: 不要なループ、非効率なアルゴリズム
- **保守性**: コードの可読性、適切な命名
- **正確性**: 意図した動作をしているか

## 4. AI との協働パターン

### 反復的な改善

1. **最小限の実装から始める**: 完璧を目指さず、動くものを作る
2. **テストして確認**: 実際に動作させて問題を特定
3. **フィードバックを提供**: AI に具体的な改善点を伝える
4. **段階的に拡張**: 機能を少しずつ追加

## 5. プロンプトテンプレート集

### コンポーネント作成

```
[コンポーネント名]コンポーネントを作成してください。

要件：
- [機能1]
- [機能2]
- [機能3]

制約：
- [制約1]
- [制約2]

スタイル：
- [スタイリングの要件]
```

### リファクタリング

```
以下のコードをリファクタリングしてください：

[コード]

改善点：
- パフォーマンスの最適化
- 可読性の向上
- 型安全性の強化
- [その他の要件]
```

### バグ修正

```
以下の問題を解決してください：

問題：[問題の説明]

現在のコード：
[コード]

期待される動作：
[期待される動作]

実際の動作：
[実際の動作]
```

### エラー解決

```
以下のエラーが発生しました：

[エラーメッセージ全文]

関連するコード：
[問題のコードスニペット]

試したこと：
- 〇〇を試したが解決しなかった
- △△も試したが同じエラー
```

## 6. セキュリティのベストプラクティス

### API キーの管理

```bash
# 環境変数を使用
API_KEY=sk-...
DATABASE_URL=https://...

# .gitignore に追加
.env
.env.local
.env.production
```

### 機密情報の扱い

- API キーや認証情報は環境変数で管理
- 機密情報を含むファイルは `.gitignore` に追加
- クライアントサイドに機密情報を露出しない

## 7. チームでの活用

- コーディング規約を `CLAUDE.md` に記載して共有
- チーム共通のカスタムコマンドを `.claude/commands/` に配置して Git で管理
- 効果的だったプロンプトをチームで共有

## 8. 継続的な学習

### プロンプトの記録

効果的だったプロンプトは記録しておくと、次回以降に活用できます：

```json
{
  "category": "code-generation",
  "task": "コンポーネント作成",
  "prompt": "...",
  "result": "success",
  "notes": "具体的な要件を列挙したのが良かった"
}
```

### コミュニティへの貢献

- 学んだことをブログ記事にする
- サンプルコードをこのリポジトリに追加
- 他の開発者とベストプラクティスを共有

## まとめ

| ポイント | 説明 |
|----------|------|
| 明確な指示 | 具体的で詳細なプロンプトを心がける |
| 段階的アプローチ | 大きなタスクは小さく分割 |
| コードレビュー | 生成されたコードは必ず確認 |
| 反復的改善 | 動くものを作り、少しずつ改善 |
| セキュリティ | 機密情報の管理を徹底 |
| 継続的学習 | 効果的なプロンプトを記録・共有 |
